PID的速度-电流双闭环一般是这样的：
转速误差PID得到预期的电流，与当前电枢电流做差，再PID得到需要输出的电压，PWM占空比=输出电压/母线电压。
调试的时候先不要转速，只调电流-电压的PID，使电流能够跟随给定电流；然后就不管电压了，转速的PID只是转速和电流的控制关系。

直流电机最基本的模型是：
电机平均电压 = 母线电压×PWM占空比
欧姆定律：“平均电压-反电动势=电流×线圈电阻”
感应电动势：“反电动势=转速×常数”，
安培力：“转矩=电流×另一个常数”，
牛顿定律：“转矩=转动惯量×角加速度”。剩下的看19楼吧。